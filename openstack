部署openstack
   此实验整体要三台机器：openstack作为主节点，nova作为额外节点，另一台作为DNS和NTP的服务器
openstack主机：openstack.tedu.cn
安装openstack的机器要求：内存10G cpu2个 磁盘50G 
          private1---eth0 :192.168.1.10/24（均为静态ip）
          private2---eth1 :192.168.4.10/24
nova主机：nova.tedu.cn
          内存6G cup2个 磁盘50G
          private1---eth0 :192.168.1.11/24
          private2---eth1 :192.168.4.11/24
配置yum仓库：镜像下载地址--- ftp://149.248.16.96/iso
将下载的三个镜像作为这两台机器的yum仓库

两台主机配置静态ip和主机名：
以openstack主机为例：
[root@localhost ~]# echo openstack.tedu.cn > /etc/hostname
[root@openstack ~]# vim /etc/sysconfig/network-scripts/ifcfg-eth0
# Generated by dracut initrd
DEVICE="eth0"
ONBOOT="yes"
IPV6INIT="no"
IPV4_FAILURE_FATAL="no"
NM_CONTROLLED="no"
TYPE="Ethernet"
BOOTPROTO="static"
IPADDR="192.168.1.10"
PREFIX=24
GATEWAY=192.168.1.254
:wq
[root@openstack ~]# systemctl restart network
eth1的配置同理---要先添加网卡eth1:命令如下：nova主机也要配置
[root@room9pc01 ~]# cd /etc/libvirt/qemu/networks/
[root@room9pc01 networks]# virsh -c qemu:///system attach-interface openstack bridge private2 --model virtio
Interface attached successfully    //添加成功
[root@openstack ~]# cd /etc/sysconfig/network-scripts
[root@openstack network-scripts]# cp ifcfg-eth0 ifcfg-eth1
[root@openstack network-scripts]# vim ifcfg-eth1
# Generated by dracut initrd
DEVICE="eth1"
ONBOOT="yes"
IPV6INIT="no"
IPV4_FAILURE_FATAL="no"
NM_CONTROLLED="no"
TYPE="Ethernet"
BOOTPROTO="static"
IPADDR="192.168.4.10"
PREFIX=24
GATEWAY=192.168.4.254
[root@openstack network-scripts]# systemctl restart network
配置域名解析：两台主机均配置
[root@openstack ~]# vim /etc/hosts
192.168.1.10 openstack.tedu.cn
192.168.1.11 nova.tedu.cn

配置时间同步：真机上做：
root@room9pc01 ~]# yum -y install chrony
[root@room9pc01 ~]# vim /etc/chrony.conf
server ntp1.aliyun.com iburst #这是阿里的时间服务器
bindacqaddress 0.0.0.0
allow 0/0   //允许所有人使用我的时间服务器 
[root@room9pc01 ~]# systemctl restart chronyd
[root@room9pc01 ~]# netstat -antup | grep chronyd
[root@room9pc01 ~]# chronyc sources -v   //出现*号代表NTP时间可用
^* 120.25.115.20  2   6    17    62   -753us[-7003us] +/-   24ms
安装openstack的依赖包：openstack.tedu.cn和nova.tedu.cn上都装
[root@openstack ~]# yum -y install qemu-kvm 
                                   libvirt-client 
                                   libvirt-daemon 
                                   libvirt-daemon-driver-qemu 
                                   python-setuptools

部署openstack:
[root@openstack ~]# yum install -y openstack-packstack
[root@openstack ~]# packstack --gen-answer-file answer.ini  
[root@openstack ~]# vim answer.ini
  11 CONFIG_DEFAULT_PASSWORD=centos  //密码
  42 CONFIG_SWIFT_INSTALL=n
  75 CONFIG_NTP_SERVERS=192.168.1.254   //时间服务器的地址
 554 CONFIG_CINDER_VOLUMES_CREATE=y    //创建卷,已经手动创建过了可以改为n
 840 CONFIG_NEUTRON_ML2_TYPE_DRIVERS=flat,vxlan   //驱动类型
 876 CONFIG_NEUTRON_ML2_VXLAN_GROUP=239.1.1.5  
    //设置组播地址,最后一个随意不能为0和255,其他固定
 910 CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=physnet1:br-ex  //物理网桥的名称
 921 CONFIG_NEUTRON_OVS_BRIDGE_IFACES=br-ex:eth0   
   //br-ex桥的名称与eth0连接，管理eth0,网桥与哪个物理网卡连接
 936 CONFIG_NEUTRON_OVS_TUNNEL_IF=eth1
1179 CONFIG_PROVISION_DEMO=n   //DEMO是否测试
[root@openstack ~]# packstack  --answer-file=answer.ini
 **** Installation completed successfully ******        //出现这个为成功
[root@openstack ~]# ls
anaconda-ks.cfg  answer.ini  keystonerc_admin 

openstack安装完成后默认是不能访问的，修改以下配置即可访问
vim /etc/httpd/conf.d/15-horizon_vhost.conf
      WSGIApplicationGroup %${GLOBAL}
 :wq
systemctl restart httpd
或
apachectl graceful 重载入配置文件

systemctl list-unit-files 查看openstack 服务
默认管理用户：admin    密码在keystonerc_admin文件里
如果在web界面修改了管理员的密码，要将密码文件中的密码也做修改
